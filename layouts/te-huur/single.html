{{ define "main" }}
  <article class="listing-detail">
    <h1>{{ .Title }}</h1>
    
    <div class="listing-layout">
      
      <!-- Images section -->
      {{ if .Params.images }}
      <div class="property-image-container">
        <div class="property-carousel">
          {{ range .Params.images }}
            <div class="carousel-cell">
              <img src="{{ . | relURL }}" alt="{{ $.Title }}" loading="lazy" />
            </div>
          {{ end }}
        </div>
        <div class="carousel-nav">
          <button class="carousel-prev" aria-label="Vorige">‹</button>
          <button class="carousel-next" aria-label="Volgende">›</button>
        </div>
      </div>
      {{ end }}

      <!-- Sidebar with specs and pricing -->
      <aside class="listing-sidebar">
        <div class="sidebar-section">
          <p class="status-info">
            <span class="status-badge status-{{ .Params.status | lower | replaceRE " " "-" }}">{{ .Params.status }}</span>
          </p>
          <p class="price-info">
            <strong>Prijs:</strong> €{{ .Params.price }}/maand
          </p>
          {{ with .Params.vaste_kosten }}
          <p class="additional-costs">
            <strong>Vaste kosten:</strong> €{{ . }}/maand
          </p>
          {{ end }}
          {{ with .Params.beschikbaar_vanaf }}
          <p class="availability-date">
            <strong>Beschikbaar vanaf:</strong> {{ . | time.Format ":date_long" }}
          </p>
          {{ end }}
          
          <!-- Property specs with icons -->
          <div class="property-specs">
            {{ with .Params.property_type }}
            <div class="spec-item">
              <span class="spec-item-icon">
                {{- if eq . "Appartement" -}}🏢
                {{- else if eq . "Huis" -}}🏠
                {{- else if eq . "Kantoor" -}}💼
                {{- else if eq . "Garage" -}}🚗
                {{- else if eq . "Overig" -}}🏘️
                {{- else -}}🏘️
                {{- end -}}
              </span>
              <span>{{ . }}</span>
            </div>
            {{ end }}
            {{ with .Params.gemeente }}
            <div class="spec-item">
              <span class="spec-item-icon">📍</span>
              <span>{{ . }}</span>
            </div>
            {{ end }}
            {{ with .Params.surface }}
            <div class="spec-item">
              <span class="spec-item-icon">📐</span>
              <span>{{ . }}m²</span>
            </div>
            {{ end }}
            
            {{ with .Params.bedrooms }}
            <div class="spec-item">
              <span class="spec-item-icon">🛏️</span>
              <span>{{ . }} slaapkamers</span>
            </div>
            {{ end }}
            {{ if .Params.garden }}
            <div class="spec-item">
              <span class="spec-item-icon">🌿</span>
              <span>Tuin</span>
            </div>
            {{ end }}
            {{ if .Params.balcony }}
            <div class="spec-item">
              <span class="spec-item-icon">🪴</span>
              <span>Balkon</span>
            </div>
            {{ end }}
          </div>
        </div>

        {{ if or .Params.epc .Params.staat .Params.beglazing .Params.verwarming .Params.water .Params.mobiscore .Params.keuken .Params.badkamer .Params.parkeerplaats .Params.lift .Params.verdieping .Params.huisdieren }}
        <div class="details sidebar-section">
          <h3>Kenmerken</h3>
          <ul>
            {{ with .Params.epc }}<li><span>✓</span><strong>EPC:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.staat }}<li><span>✓</span><strong>Staat:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.beglazing }}<li><span>✓</span><strong>Beglazing:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.verwarming }}<li><span>✓</span><strong>Verwarming:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.water }}<li><span>✓</span><strong>Water:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.mobiscore }}<li><span>✓</span><strong>Mobiscore:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.keuken }}<li><span>✓</span><strong>Keuken:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.badkamer }}<li><span>✓</span><strong>Badkamer:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.parkeerplaats }}<li><span>✓</span><strong>Parkeerplaats:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.lift }}<li><span>✓</span><strong>Lift:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.verdieping }}<li><span>✓</span><strong>Verdieping:</strong>&nbsp;{{ . }}</li>{{ end }}
            {{ with .Params.huisdieren }}<li><span>✓</span><strong>Huisdieren:</strong>&nbsp;{{ . }}</li>{{ end }}
          </ul>
        </div>
        {{ end }}

        {{ if .Params.address }}
        <div class="map-container">
          <iframe
            width="100%"
            height="250"
            loading="lazy"
            allowfullscreen
            src="https://www.google.com/maps/embed/v1/place?key={{ site.Params.googleMapsApiKey }}&q={{ .Params.address | urlquery }}">
          </iframe>
        </div>
        {{ end }}

        <div class="contact-cta">
          <a href="{{ "/contact" | relURL }}" class="btn-cta">Contact Opnemen</a>
        </div>

      </aside>

      <!-- Content section -->
      <div class="content">
        <h2 style="border-bottom: 2px solid #99c5ff;">Beschrijving</h2>
        
        <div>
          {{ .Content }}
        </div>
      </div>
    </div>

    <div class="back-to-overview">
      <a href="{{ "/te-huur" | relURL }}" class="btn-secondary">Terug naar Overzicht</a>
    </div>

  </article>
  {{ partial "carousel-scripts.html" . }}
{{ end }}